# Practice 8 — Разработка гибридного приложения для CPU и GPU


## Цель
1) Реализовать обработку массива на CPU с OpenMP (умножение на 2)  
2) Реализовать обработку массива на GPU с CUDA (умножение на 2)  
3) Реализовать гибридную обработку: первая половина массива обрабатывается CPU, вторая — GPU одновременно  
4) Сравнить время CPU, GPU и Hybrid и проанализировать, когда гибридный подход выгоден

---

## Что сделано

### CPU (OpenMP)
- Массив обрабатывается на CPU параллельным циклом `#pragma omp parallel for`
- Каждый элемент умножается на 2
- Время измеряется через `chrono`

### GPU (CUDA)
- Данные копируются на GPU (Host → Device)
- Запускается kernel `mul2_kernel`, который умножает элементы на 2
- Результат копируется обратно (Device → Host)
- Время измеряется через CUDA events

### Hybrid (CPU + GPU одновременно)
- Массив делится на две части:
  - первая половина умножается на CPU (OpenMP)
  - вторая половина обрабатывается на GPU (CUDA)
- Для GPU используется `cudaMemcpyAsync` + stream, чтобы копирование и kernel работали параллельно с CPU
- Используется pinned memory (`cudaMallocHost`), чтобы асинхронные копии работали корректно
- Время измеряется через CUDA events

---

## Проверка корректности
- Сравниваются первые 1000 элементов:
  - CPU vs GPU
  - CPU vs Hybrid
- Если совпадает — выводится OK

---

## Запуск в Google Colab (Tesla T4)
### Компиляция и запуск
```bash
nvcc -O2 -Xcompiler -fopenmp -gencode arch=compute_75,code=sm_75 practice8.cu -o practice8
./practice8
